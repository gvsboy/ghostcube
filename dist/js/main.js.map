{"version":3,"sources":["dist/js/main.js"],"names":[],"mappings":"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","file":"dist/js/main.js","sourcesContent":["function App(containerId) {\n\n  // The site container which houses the cube and intro text.\n  this.container = document.getElementById(containerId);\n\n  // Check if the client is on a mobile device.\n  this.isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);\n\n  // The fun part!\n  this.cube = new Cube(this.container.getElementsByClassName('cube')[0]);\n\n  // UI for displaying various messages.\n  this.messages = new Messages();\n\n  // An object that detects user interaction to manipulate the cube.\n  this.renderer = new Renderer(this.cube, this.isMobile);\n\n  // In-game players.\n  this.players = null;\n  this.currentPlayer = null;\n\n  // Cross-selected tile for helping attacks.\n  this._helperTile = null;\n\n  // Step-by-step instruction component.\n  this.tutorial = new Tutorial();\n\n  // Records moves as they're made. Can be used to step through time.\n  this.recorder = new Recorder(this);\n\n  // Listen for user interactions.\n  this.idle();\n}\n\nApp.prototype = {\n\n  /**\n   * Configures the cube object's default pre-game state.\n   */\n  idle: function() {\n\n    var cube = this.cube,\n        cubeEl = cube.el,\n        container = this.container;\n\n    // Click the cube to begin the game.\n    UTIL.listenOnce(cubeEl, 'click', () => {\n\n      cubeEl.classList.remove('splash');\n      container.classList.add('game');\n\n      UTIL.listenOnce(container, Vendor.EVENT.animationEnd, evt => {\n        // Every animated cube face will bubble up their animation events\n        // so let's react to only one of them.\n        if (evt.target === container) {\n          cube\n            .build()\n            .then(_.bind(this.initializeGame, this));\n        }\n      });\n    });\n  },\n\n  /**\n   * Configures the cube for game mode by creating players, setting listeners,\n   * and initializing the renderer.\n   */\n  initializeGame: function() {\n\n    // Create the players and set the first one as current.\n    var human = new Player('Kevin', 'player1', this.cube),\n        bot = new Bot('CPU', 'player2', this.cube, human);\n\n    this.players = [human, bot];\n\n    // The message box listens for messages to display.\n    this.messages.listenTo(this.tutorial);\n\n    this.setCurrentPlayer(_.first(this.players));\n\n    // Begin the rendering.\n    this.renderer.initialize();\n\n    this.renderer.on('start', _.bind(this.clearHelperTile, this));\n\n    // Not really into this but sure for now.\n    _.forEach(this.players, function(player) {\n      player\n        .on('player:initialSelected', _.bind(this.showCrosshairs, this))\n        .on('player:initialDeselected', _.bind(this.hideCrosshairs, this))\n        .on('player:claim', _.bind(this._endTurn, this))\n        .on('player:stalemate', _.bind(this._stalemate, this))\n    }, this);\n\n    this.tutorial.next().next();\n  },\n\n  enableCubeInteraction: function() {\n    this.cube\n      .listenTo('click', this._handleClick, this)\n      .listenTo('mouseover', this._handleMouseOver, this)\n      .listenTo('mouseout', this._handleMouseOut, this);\n  },\n\n  disableCubeInteraction: function() {\n    this.cube\n      .stopListeningTo('click')\n      .stopListeningTo('mouseover')\n      .stopListeningTo('mouseout');\n  },\n\n  /**\n   * Sets the current player to the passed player, displaying the correct\n   * messaging and updating the UI state.\n   * @param {Player} player    The player to set as the current player.\n   * @param {Boolean} botManual Should the bot play it's turn automatically?\n   *                            Used in recorder mode to pause auto playback.\n   */\n  setCurrentPlayer: function(player, botManual) {\n\n    // Broadcast that it's the passed player's turn.\n    this.messages.add(player.name + '\\'s turn!', 'alert');\n\n    // Don't set the same player twice.\n    if (this.currentPlayer !== player) {\n\n      this.cube.el.classList.add(player.tileClass + '-turn');\n      if (this.currentPlayer) {\n        this.cube.el.classList.remove(this.currentPlayer.tileClass + '-turn');\n      }\n\n      this.currentPlayer = player;\n\n      if (player.isBot()) {\n        this.disableCubeInteraction();\n        if (!botManual) {\n          player.play();\n        }\n      }\n      else {\n        this.enableCubeInteraction();\n      }\n    }\n  },\n\n  getOpponent: function(player) {\n    return this.players[this.players.indexOf(player) === 1 ? 0 : 1];\n  },\n\n  showCrosshairs: function(tile) {\n    tile.addClass('selected');\n    this.cube.updateCrosshairs(tile, tile => tile.addClass('highlighted'));\n    this.tutorial.next();\n  },\n\n  hideCrosshairs: function(tile) {\n    tile.removeClass('selected');\n    this.cube.updateCrosshairs(tile, tile => tile.removeClass('highlighted'));\n  },\n\n  clearHelperTile: function() {\n    if (this._helperTile) {\n      this._helperTile.removeClass('helper');\n    }\n    this._helperTile = null;\n  },\n\n  /**\n   * Ends the current player's turn and determines if the game is\n   * in a win state.\n   * @param  {Array} tiles The tiles selected to end the turn.\n   */\n  _endTurn: function(tiles) {\n\n    var player = this.currentPlayer,\n        lines = player.getWinLines();\n\n    this.recorder.record(player, tiles);\n    this.clearHelperTile();\n    this.hideCrosshairs(_.first(tiles));\n\n    // If the player has made at least one line, end the game.\n    if (!this._endGame(lines)) {\n      this.setCurrentPlayer(this.getOpponent(player));\n    }\n  },\n\n  /**\n   * Attempts to end the game.\n   * @param  {Array} lines The lines used to win.\n   * @return {Boolean} Is the game in a win state?\n   */\n  _endGame: function(lines) {\n\n    var winBy = lines.length,\n        modifier;\n\n    if (winBy) {\n\n      // Display message with modifier.\n      modifier = winBy > 1 ? ' x' + winBy + '!' : '!';\n      this.messages.add(`${this.currentPlayer.name} wins${modifier}`, 'alert persist');\n\n      // Show the winning lines.\n      _.invoke(lines, 'pulsate');\n\n      // Alert the user on how to start a new game.\n      this._waitAndListenForReset();\n\n      // Yes, the game has ended.\n      return true;\n    }\n\n    // Nobody has won yet. Continue!\n    return false;\n  },\n\n  /**\n   * Reveal messages regarding the stalemate and begin listening to\n   * start a new game.\n   */\n  _stalemate: function() {\n    this.messages\n      .add('stalemate', 'alert persist')\n      .add(`${this.currentPlayer.name} has no valid moves.`, 'persist');\n    this._waitAndListenForReset();\n  },\n\n  /**\n   * After a brief pause, alerts the user about how to start a new game\n   * and sets a listener.\n   */\n  _waitAndListenForReset: function() {\n    setTimeout(() => {\n      this.messages.add('newGame', 'persist');\n      UTIL.listenOnce(document, 'click', _.bind(this._resetGameState, this));\n    }, 2000);\n  },\n\n  /**\n   * Removes all claimed tiles from each player and destroys all messages.\n   * Sets the current player to the first player in the array.\n   */\n  _resetGameState: function() {\n    _.forEach(this.players, player => player.releaseAll());\n    this.messages.removeAll();\n    this.setCurrentPlayer(_.first(this.players));\n  },\n\n  // Potentially dangerous as this is hackable...\n  // Perhaps do a straigh-up element match too?\n  _getTileFromElement: function(el) {\n    var data;\n    if (el.classList.contains('tile')) {\n      data = el.id.split('-');\n      return this.cube.getSides(data[0]).getTiles(data[1])[0];\n    }\n    return null;\n  },\n\n  _handleClick: function(evt) {\n\n    // Get the target element from the event.\n    var tile = this._getTileFromElement(evt.target);\n\n    // If the tile exists, try to select it.\n    if (tile) {\n      try {\n        this.currentPlayer.selectTile(tile, this._helperTile);\n        this.tutorial.next().next();\n      }\n\n      // An error was thrown in the tile selection process. Handle it.\n      catch(e) {\n        if (e instanceof SelectTileError) {\n          this.messages.add(e.message);\n        }\n        else {\n          throw e;\n        }\n      }\n    }\n  },\n\n  _handleMouseOver: function(evt) {\n\n    // The tile the user is interacting with.\n    var tile = this._getTileFromElement(evt.target),\n\n        // The first tile that has been selected.\n        initialTile = this.currentPlayer.getInitialTile();\n\n    // If the user is hovering on a neighboring side of the initial tile,\n    // highlight some targeting help on a visible side.\n    this._helperTile = this.cube.getAttackTile(tile, initialTile);\n\n    if (this._helperTile) {\n      this._helperTile.addClass('helper');\n    }\n  },\n\n  _handleMouseOut: function(evt) {\n    this.clearHelperTile();\n  }\n\n};\n\nfunction Bot(name, tileClass, cube, opponent) {\n  Player.call(this, name, tileClass, cube);\n  this.opponent = opponent;\n}\n\nBot.THINKING_SPEED = 600;\n\nBot.prototype = {\n\n  getInitialTriedTile: function() {\n    return _.first(this._triedTiles);\n  },\n\n  play: function() {\n\n    this._initLog();\n\n    this._log('================== BOT MOVE ==================');\n\n    this._triedTiles = [];\n\n    /*\n      First, gather all the Bot's tiles to see if a win is possible this turn\n      (there are lines that are missing one tile).\n      If so, attempt to claim those tiles.\n\n      If no win is possible, gather the opponent's tiles to see if a win is possible.\n      If so, see which method can block:\n\n        - Neutralizing a tile?\n        - Claiming the missing tile?\n     */\n\n    this._selectWin() ||\n    this._selectOpponentBlocker() ||\n    this._selectSingles() ||\n    this._selectOpponentSingles() ||\n    this._selectLastResort() ||\n    this.emit('player:stalemate', this._selectedTiles);\n  },\n\n  _selectWin: function() {\n\n    var lines = this.getLines(),\n        initialTile,\n        tile;\n\n    this._log('++++++ WIN lines:', lines);\n\n    for (var i = 0, len = lines.length; i < len; i++) {\n\n      initialTile = this.getInitialTriedTile();\n      tile = lines[i].missingTiles()[0];\n\n      this._log('+++ WIN loop [initial, tile] :', initialTile, tile);\n\n      // If there's a tile selected already, try to seal the deal with two more.\n      if (initialTile && tile) {\n\n        // First try to claim another win situation.\n        // If that doesn't work out, try to claim by any means necessary.\n        var attackTile = this.getAttackTile(initialTile, tile);\n        if (attackTile && this._tryTiles(tile, attackTile)) {\n          return true; // Done! The tiles will be claimed.\n        }\n      }\n      else {\n        this._tryTiles(tile);\n      }\n    }\n\n    // More tiles must be selected to complete the turn.\n    return false;\n  },\n\n  _selectOpponentBlocker: function() {\n\n    var lines = this.opponent.getLines(),\n        initialTile,\n        tile;\n\n    this._log('@@@@@@ BLOCK lines:', lines);\n\n    for (var i = 0, len = lines.length; i < len; i++) {\n\n      initialTile = this.getInitialTriedTile();\n      tile = lines[i].missingTiles()[0];\n\n      this._log('@@@ BLOCK loop [initial, tile] :', initialTile, tile);\n\n      // If there's a tile selected already, try to seal the deal with two more.\n      if (initialTile && tile) {\n        var attackTile = this.getAttackTile(initialTile, tile);\n        if (attackTile && this._tryTiles(tile, attackTile)) {\n          return true; // Done! The tiles will be claimed.\n        }\n      }\n      else {\n        this._tryTiles(tile);\n      }\n    }\n\n    // More tiles must be selected to complete the turn.\n    return false;\n  },\n\n  _selectOpponentSingles: function() {\n    return this._selectSingles(true);\n  },\n\n  _selectSingles: function(useOpponent) {\n\n    var singles = _.shuffle(useOpponent ? this.opponent.getSingles() : this.getSingles()),\n        initialTile,\n        tile;\n\n    this._log('------ SINGLES' + (useOpponent ? ' OPPONENT:' : ':'), singles);\n\n    for (var t = 0, len = singles.length; t < len; t++) {\n\n      initialTile = this.getInitialTriedTile();\n\n      // If there is no initial tile or this singles selection is on a neighboring\n      // side, make a selection attempt.\n      if (!initialTile || singles[t].isNeighboringSide(initialTile)) {\n        tile = this._selectByTileLine(singles[t]);\n      }\n\n      this._log('--- singles loop [initial, tile] :', initialTile, tile);\n\n      if (initialTile && tile) {\n        var attackTile = this.getAttackTile(initialTile, tile);\n        if (attackTile && this._tryTiles(tile, attackTile)) {\n          return true; // Done! The tiles will be claimed.\n        }\n\n        // Otherwise, remove the last tried tile. The attack combo won't work.\n        else {\n          this._triedTiles = _.dropRight(this._triedTiles);\n        }\n      }\n    }\n\n    // More tiles must be selected to complete the turn.\n    return false;\n  },\n\n  // This is similar to 'isStalemate' and consideration should be given\n  // for consolidation.\n  _selectLastResort: function() {\n\n    var self = this;\n\n    function attempt(tile) {\n\n      var testTile;\n\n      for (var t = 0, len = tiles.length; t < len; t++) {\n        testTile = tiles[t];\n        var attackTile = self.getAttackTile(tile, testTile);\n        if (attackTile && self._tryTiles(testTile, attackTile)) {\n          return true;\n        }\n      }\n      return false;\n    }\n\n    var initialTile = this.getInitialTriedTile(),\n        tiles = this._cubeCache._cube.getAvailableTiles(initialTile);\n\n    this._log('$$$$$ LAST RESORT');\n\n    // If there is an initial tile, try to match it first.\n    if (initialTile) {\n      if (attempt(this.getInitialTriedTile())) {\n        return true;\n      }\n    }\n\n    // Otherwise, go through all the tiles and try to find a match.\n    for (var e = 0, len = tiles.length; e < len; e++) {\n      this._triedTiles = [];\n      this._tryTiles(tiles[e]);\n      if (attempt(tiles[e])) {\n        return true;\n      }\n    }\n\n  },\n\n  /**\n   * Attempts to select a tile on the same line as the given tile.\n   * Scans both x and y lines, shuffling the collection.\n   * @param  {Tile} tile The target tile.\n   * @return {Tile}      The selected tile.\n   */\n  _selectByTileLine: function(tile) {\n\n    // Grab all the tiles on the same line as the passed tile.\n    var lineTiles = _.shuffle(tile.getAllLineTiles());\n\n    // Return the first tile that is a valid selection.\n    return _.find(lineTiles, function(ti) {\n      return this._tryTiles(ti);\n    }, this);\n  },\n\n  /**\n   * A wrapper around selectTile that swallows SelecTileErrors to\n   * prevent the UI from reacting to them. Useful for programmatically\n   * determining moves.\n   * @param  {Tile} tile1 A tile to attempt.\n   * @param  {Tile} tile2 A second tile to attempt.\n   * @return {Boolean} Can the provided tiles be selected?\n   */\n  _tryTiles: function(tile1, tile2) {\n    try {\n      this.selectTile(tile1, tile2);\n      return true;\n    }\n    catch (e) {\n      if (!(e instanceof SelectTileError)) {\n        throw e;\n      }\n    }\n    return false;\n  },\n\n  _selectTiles: function() {\n\n    var tiles = _.union(this._triedTiles, arguments);\n\n    this._triedTiles = tiles;\n\n    this._log('^^^^^^^^^^^^^^^^^^^^ _triedTiles is now:', this._triedTiles);\n\n    if (this._triedTiles.length === 3) {\n      setTimeout(() => {\n        this._report();\n        this._cubeCache._cube.rotateToTiles(this._triedTiles).then(() => {\n          this._animateClaim();\n        });\n      }, Bot.THINKING_SPEED);\n    }\n  },\n\n  _animateClaim: function() {\n    setTimeout(_.bind(function() {\n      var tile = this._triedTiles.shift();\n      Player.prototype._selectTiles.call(this, tile);\n      if (!_.isEmpty(this._triedTiles)) {\n        this._animateClaim();\n      }\n    }, this), Bot.THINKING_SPEED);\n  },\n\n  _report: function() {\n    var info = _.reduce(this._triedTiles, function(all, tile) {\n      all.push(tile.toString ? tile.toString() : tile);\n      return all;\n    }, []);\n    this._log('### Bot will try:', info.join(' | '));\n  },\n\n  _initLog: function() {\n    this._logText = '';\n  },\n\n  _log: function() {\n\n    var text = _.reduce(arguments, function(lines, data) {\n      lines.push(!_.isEmpty(data) ? data.toString() : 'NONE');\n      return lines;\n    }, []).join(' ');\n\n    // Immediately output the message in the console.\n    //console.log(text);\n\n    // Append the text to the master log.\n    this._logText += text + '\\n';\n  }\n\n};\n\nfunction Cube(el, size) {\n\n  // The HTML element representing the cube.\n  this.el                     = el;\n\n  // The cube's size regarding tiles across a side. Default to 3.\n  this.size                   = size || 3;\n\n  // Cached reference to the style object.\n  this.style                  = this.el.style;\n\n  // This will be set in beginGame.\n  this._sides = null;\n\n  this._eventMap = {};\n}\n\nCube.ROTATE_X_PREFIX = 'rotateX(';\nCube.ROTATE_Y_PREFIX = 'rotateY(';\nCube.ROTATE_UNIT_SUFFIX = 'deg)';\nCube.REVOLUTION = 360;\nCube.ROTATION_UNIT = 90;\nCube.ORIGIN = 0;\n\nCube.prototype = {\n\n  /**\n   * Builds the game-mode version of the cube, slowing down the idle state\n   * to a stop and transitioning to the center of the screen. The initial\n   * rotation coordinate values are set and the sides are generated with their\n   * child tiles.\n   * @return {Promise} A promise that resolves when the transition ends.\n   */\n  build: function() {\n\n    // Create the game sides. The tiles will animate into existence from a\n    // trigger function during each side's creation.\n    this._sides = this._buildSides(this.size);\n\n    // Set the initial rotated state. Cut at 45 degrees to always display three sides.\n    this.x = this.y = Cube.REVOLUTION - (Cube.ROTATION_UNIT / 2);\n\n    return new Promise(resolve => {\n\n      // A reference to the cube's element.\n      var el = this.el;\n\n      // After the cube's rotation animation has made one loop, begin to slow it down.\n      el.addEventListener(Vendor.EVENT.animationIteration, function() {\n        el.classList.add('transition');\n        el.addEventListener(Vendor.EVENT.animationEnd, function animEnd(evt) {\n          if (evt.target === el) {\n\n            // Remove the transition class and append the init class. Done!\n            el.classList.remove('transition');\n            el.classList.add('init');\n\n            // Let's go!\n            resolve();\n          }\n        });\n      });\n    });\n  },\n\n  /**\n   * Sets a renderer so the cube can render itself. This is a bit hacky; please find\n   * another way to accomplish self-rendering.\n   * @param {Renderer} renderer The renderer to set on the cube.\n   */\n  setRenderer: function(renderer) {\n    this._renderer = renderer;\n  },\n\n  rotate: function(x, y) {\n    this.x = this._calculateCoordinate(this.x, x);\n    this.y = this._calculateCoordinate(this.y, y);\n\n    this.style[Vendor.JS.transform] =\n      Cube.ROTATE_X_PREFIX + this.x + Cube.ROTATE_UNIT_SUFFIX + ' ' + Cube.ROTATE_Y_PREFIX + this.y + Cube.ROTATE_UNIT_SUFFIX;\n  },\n\n  /**\n   * Calculate the rotation needed to display all the given tiles which\n   * must be neighbors to each other (for obvious reasons).\n   * @param  {Array} tiles A collection of tiles (three maximum).\n   * @return {Promise} A promise that resolves when the rotation is complete.\n   */\n  rotateToTiles: function(tiles) {\n\n    // First, collect all the common coordinates each tile shares when visible.\n    var pairs = this._getCommonVisibleCoordinates(tiles),\n\n        // Next, get calculate the shortest rotation distance from the pairs.\n        coors = this._getShortestRotationDistance(pairs);\n\n    // Return a promise that will resolve when the cube's rotation render completes.\n    return new Promise(resolve => {\n      this._renderer\n        .setMovement(coors[0], coors[1])\n        .then(resolve);\n    });\n  },\n\n  listenTo: function(eventName, callback, context) {\n\n    var events = this._eventMap,\n        handler = _.bind(callback, context || this);\n\n    if (!events[eventName]) {\n      events[eventName] = [];\n    }\n\n    this._eventMap[eventName].push(handler);\n    this.el.addEventListener(eventName, handler);\n\n    return this;\n  },\n\n  stopListeningTo: function(eventName) {\n\n    _.forEach(this._eventMap[eventName], function(handler) {\n      this.el.removeEventListener(eventName, handler);\n    }, this);\n\n    return this;\n  },\n\n  /**\n   * Fetches a cube side by name (e.g. 'top')\n   * @param  {String} name The name of the side you want.\n   * @return {Side}      The Side object by name.\n   */\n  getSides: function(name) {\n    return name ? this._sides[name] : this._sides;\n  },\n\n  /**\n   * @return {Array} The three visible sides.\n   */\n  getVisibleSides: function() {\n\n  },\n\n  /**\n   * Retrieves all the unclaimed tiles and sorts them by the amount per\n   * side in ascending order. If an exception tile is passed, do not include\n   * unclaimed tiles from that tile's side.\n   * @param  {Tile} except The tile whose side to exclude.\n   * @return {Array} A list of all the available tiles.\n   */\n  getAvailableTiles: function(except) {\n\n    // Get all the tiles by side and push each array to the main array list.\n    var tilesBySide = _.reduce(this.getSides(), function(list, side) {\n      if (!except || side !== except.side) {\n        list.push(_.shuffle(side.getAvailableTiles()));\n      }\n      return list;\n    }, []);\n\n    // Sort each side's array by length and then flatten the whole thing.\n    return _.flatten(_.sortBy(tilesBySide, 'length'));\n  },\n\n  /**\n   * Updates the passed tile and all related adjacent tiles with the\n   * passed callback. This method is mostly used for highlighting tiles\n   * to help the user make strategy decisions easier.\n   * @param  {DOMElement}   tile The selected tile as a raw DOM element.\n   * @param  {Function}     callback   The method to invoke passing each tile as an argument.\n   */\n  updateCrosshairs: function(tile, callback) {\n\n    // Run the callback on all tiles in the lines associated with the given tile.\n    _.forEach(tile.getAllLineTiles(), callback);\n\n    // For each neighbor, pass in the side and the orientation id (e.g. 'left').\n    _.forEach(tile.side.getNeighbors(), neighbor => {\n\n      // Find the translated tiles and run the callback on each.\n      _.forEach(tile.translate(neighbor), callback);\n    });\n  },\n\n  /**\n   * Gets the tile where the two passed tile's coordinates intersect.\n   * @param {Tile} [tile1] The first tile selected.\n   * @param {Tile} [tile2] The second tile selected.\n   * @return {Tile}       The tile being attacked.\n   */\n  getAttackTile: function(tile1, tile2) {\n\n    var neighbors, side;\n\n    if (tile1 && tile2 && tile1.isNeighboringSide(tile2)) {\n\n      // Get the neighbor sides and exclude the selected side.\n      neighbors = _.without(tile2.side.getNeighbors(), tile1.side),\n\n      // Get the neighbor that is visible.\n      side = _.find(neighbors, neighbor => neighbor.isVisible(this.x, this.y));\n\n      // Return the tile that intersects the two passed tiles.\n      return _.intersection(tile1.translate(side), tile2.translate(side))[0];\n    }\n\n    return null;\n  },\n\n  /**\n   * Given a current coordinate, update it with the difference.\n   * If the result is out of the revolution bounds (between 0 and 360),\n   * adjust it to a valid value.\n   * @param  {Number} current    The current coordinate value.\n   * @param  {Number} difference The value to update the current coordinate by.\n   * @return {Number}            The normalized result.\n   */\n  _calculateCoordinate: function(current, difference) {\n\n    var REVOLUTION = Cube.REVOLUTION,\n        result = current + difference;\n\n    if (result > REVOLUTION) {\n      result = result - REVOLUTION;\n    }\n    else if (result <= Cube.ORIGIN) {\n      result = REVOLUTION - result;\n    }\n\n    return result;\n  },\n\n  /**\n   * Calculates all the possible x/y coordinate combinations that exist\n   * where all the given tiles will be visible.\n   * @param  {Array} tiles The tiles to test.\n   * @return {Array}       A collection of valid coordinate collections.\n   *                       e.g. [[225, 225], [315, 45]]\n   */\n  _getCommonVisibleCoordinates: function(tiles) {\n\n    // Collect the visibility map of each passed tile into an array.\n    var visibilityMap = _.map(tiles, tile => tile.side._visibilityMap),\n\n        // Find all the x coordinates shared by all the tiles.\n        xCoors = _.intersection.apply(_, _.map(visibilityMap, function(map) {\n          return _.map(_.keys(map), _.parseInt);\n        })),\n\n        // Given the available x coordinates, find the shared y coordinates.\n        yCoors = _.flatten(_.map(xCoors, function(coor) {\n          return _.intersection.apply(_, _.pluck(visibilityMap, coor));\n        }));\n\n    // Return a collection of x/y collections shared among all the passed tiles.\n    return _.zip(xCoors, yCoors);\n  },\n\n  /**\n   * Calculates the shortest rotation distance between an origin coordinate\n   * and a target coordinate. Accounts for the circular continuation loop from 360\n   * to 0 and the reverse.\n   * @param  {Number} originCoor The coordinate you're currently at.\n   * @param  {Number} targetCoor The coordinate you wish to be at.\n   * @return {Number}            The shortest rotation movement to reach the target.\n   */\n  _getShortestCoordinateDiff: function(originCoor, targetCoor) {\n\n    var revolution = Cube.REVOLUTION,\n        diff = targetCoor - originCoor;\n\n    // If the absolute difference is more than half of a revolution, we need to\n    // take the circular continuation into account to get the shortest distance.\n    if (Math.abs(diff) > revolution / 2) {\n\n      // If the target is higher than the origin, we need to go into reverse.\n      if (targetCoor > originCoor) {\n        diff = targetCoor - revolution - originCoor;\n      }\n\n      // Otherwise, let's move ahead.\n      else {\n        diff = revolution - originCoor + targetCoor;\n      }\n    }\n\n    return diff;\n  },\n\n  /**\n   * Calculates the shortest rotation distance given a collection of\n   * coordinate pairs. This method is meant to be used with data provided\n   * by _getCommonVisibleCoordinates.\n   * @param  {Array} pairs A collection of coordinate pairs.\n   * @return {Array}       A single coordinate pair. e.g. [45, 135]\n   */\n  _getShortestRotationDistance: function(pairs) {\n\n    return _.reduce(pairs, function(lowest, current) {\n\n      // First, determine shortest differences for each coordinate so we can\n      // compare them to a previous lowest pair.\n      var diff = [\n        this._getShortestCoordinateDiff(this.x, current[0]),\n        this._getShortestCoordinateDiff(this.y, current[1])\n      ];\n\n      // If a lowest pair hasn't been set yet or the sum of the current coor\n      // differences is less than the previously set lowest pair's, then return\n      // the current pair as the lowest.\n      if (!lowest || Math.abs(diff[0]) + Math.abs(diff[1]) < Math.abs(lowest[0]) + Math.abs(lowest[1])) {\n        return diff;\n      }\n\n      // Otherwise, return the lowest.\n      return lowest;\n    }, null, this);\n  },\n\n  _buildSides: function(size) {\n\n    // Create sides.\n    var sides = _.reduce(this.el.children, function(list, el) {\n      list[el.id] = new Side(el, size);\n      return list;\n    }, {});\n\n    var TOP = sides.top,\n        BOTTOM = sides.bottom,\n        FRONT = sides.front,\n        BACK = sides.back,\n        LEFT = sides.left,\n        RIGHT = sides.right;\n\n    // Pretty crappy ... FOR TESTING ONLY!\n    var neighborMap = {\n      top: [BACK, FRONT, LEFT, RIGHT],\n      bottom: [FRONT, BACK, LEFT, RIGHT],\n      front: [TOP, BOTTOM, LEFT, RIGHT],\n      back: [BOTTOM, TOP, LEFT, RIGHT],\n      left: [TOP, BOTTOM, BACK, FRONT],\n      right: [TOP, BOTTOM, FRONT, BACK]\n    };\n\n    var visibilityMap = {\n      // x: [y]\n      front: {\n        '315':    [45, 315],\n        '45':     [45, 315],\n        '135':    [135, 225],\n        '225':    [135, 225]\n      },\n\n      back: {\n        '315':    [135, 225],\n        '45':     [135, 225],\n        '135':    [45, 315],\n        '225':    [45, 315]\n      },\n\n      top: {\n        '315':    [45, 135, 225, 315],\n        '225':    [45, 135, 225, 315]\n      },\n\n      bottom: {\n        '135':    [45, 135, 225, 315],\n        '45':     [45, 135, 225, 315]\n      },\n\n      left: {\n        '315':    [45, 135],\n        '45':     [45, 135],\n        '135':    [225, 315],\n        '225':    [225, 315]\n      },\n\n      right: {\n        '315':    [225, 315],\n        '45':     [225, 315],\n        '135':    [45, 135],\n        '225':    [45, 135]\n      }\n    };\n\n    // Now set the neighbors for each side.\n    return _.forIn(sides, function(side) {\n      side.setNeighbors(neighborMap[side.id]);\n      side.setVisibilityMap(visibilityMap[side.id]);\n    });\n  }\n\n};\n\n/**\n * Lines represent tiles in either a horizontal or vertical row\n * which serve as points or win states.\n * @param {Array} tiles  A collection of tiles that compose the line.\n */\nfunction Line(tiles) {\n  this.side = _.first(tiles).side;\n  this.update(tiles);\n}\n\nLine.prototype = {\n\n  /**\n   * Outputs useful identifying information for troubleshooting.\n   * @return {String} String information.\n   */\n  toString: function() {\n    var info = _.reduce(this.getTiles(), function(tiles, tile) {\n      tiles.push(tile.toString());\n      return tiles;\n    }, []);\n    return '(' + info.join(' ') + ')';\n  },\n\n  /**\n   * Checks to see if the line contains all of the passed tiles.\n   * @param  {Array} tiles The tiles to check.\n   * @return {Boolean} Does the line contain the passed tiles?\n   */\n  all: function(tiles) {\n    var lineTiles = this.getTiles();\n    return _.every(tiles, tile => {\n      return _.includes(lineTiles, tile);\n    });\n  },\n\n  /**\n   * Checks to see if all the tiles in the line are included in\n   * the passed tiles array.\n   * @param  {[type]} tiles [description]\n   * @return {[type]}       [description]\n   */\n  some: function(tiles) {\n    return _.every(this.getTiles(), tile => {\n      return _.includes(tiles, tile);\n    });\n  },\n\n  update: function(tiles) {\n    this._tiles = tiles;\n  },\n\n  /**\n   * Updates the UI to display a winning state involving the line.\n   */\n  pulsate: function() {\n    _.forEach(this.getTiles(), tile => tile.addClass('win'));\n  },\n\n  /**\n   * Reports whether or not the line is horizontal by checking the\n   * index difference between two adjacent tiles.\n   * @return {Boolean} Is this line horizontal?\n   */\n  isHorizontal: function() {\n    var tiles = this.getTiles();\n    return _.includes(tiles[0].xLine.getTiles(), tiles[1]);\n  },\n\n  /**\n   * @return {Array} A collection of tiles that compose the line.\n   */\n  getTiles: function() {\n    return this._tiles;\n  },\n\n  /**\n   * @return {Number} The number of tiles in the line.\n   */\n  length: function() {\n    return this._tiles.length;\n  },\n\n  /**\n   * @return {Array} The indicies of all the tiles.\n   */\n  indicies: function() {\n    return _.map(this.getTiles(), 'index');\n  },\n\n  /**\n   * @return {Array} A collection of the missing tiles.\n   */\n  missingTiles: function() {\n\n    var tiles = this.getTiles(),\n\n        // Are we matching against a horizontal or vertical line?\n        matchedLine = this.isHorizontal() ? _.first(tiles).xLine : _.first(tiles).yLine;\n\n    // Now we can figure out which tiles are missing by diffing the two lines.\n    return _.xor(tiles, matchedLine.getTiles());\n  },\n\n  // Rotate in place, like a Tetrad. For instance:\n  // xoo      xxx\n  // xoo  ->  ooo\n  // xoo      ooo\n  rotate: function() {\n\n    // Where the line begins, starting from top-left.\n    var originIndex = _.first(this.getTiles()).index;\n\n    if (this.isHorizontal()) {\n      return this.side.getTiles(originIndex + (originIndex / this.length()))[0].yLine;\n    }\n\n    return this.side.getTiles(originIndex * this.length())[0].xLine;\n  },\n\n  // Flip across a median. For instance:\n  //    xoo      oox\n  //    xoo  ->  oox\n  //    xoo      oox\n  flip: function() {\n\n    // Where the line begins, starting from top-left.\n    var originIndex = _.first(this.getTiles()).index,\n\n        // The middle line.\n        middle;\n\n    if (this.isHorizontal()) {\n\n      // The middle row, which is the size squared cut in half and floored.\n      // NOTE: This could be buggy with other sizes!\n      middle = Math.floor((Math.pow(this.length(), 2) / 2) - 1);\n\n      // Determine the difference and get the calculated x line.\n      return this.side.getTiles(middle * 2 - originIndex)[0].xLine;\n    }\n\n    // The middle column.\n    middle = (this.length() - 1) / 2;\n\n    // Determine the difference and get the calculated y line.\n    return this.side.getTiles(middle * 2 - originIndex)[0].yLine;\n  }\n\n};\n\nfunction Side(el, size) {\n\n  // HTML element representing the side.\n  this.el = el;\n\n  // The face id (top, bottom, front, back, left, right).\n  this.id = el.id;\n\n  // This will be set using setNeighbors().\n  this._neighbors = {};\n\n  // An array of all the tiles by index.\n  this._tiles = this._buildTiles(size);\n}\n\nSide.prototype = {\n\n  getNeighbors: function() {\n    return this._neighbors;\n  },\n\n  setNeighbors: function(sides) {\n    this._neighbors = sides;\n  },\n\n  /**\n   * A check to determine if the passed side is one of this side's neighbors.\n   * @param  {Side}  side The side object to check.\n   * @return {Boolean}      Is the passed side a neighbor?\n   */\n  isNeighbor: function(side) {\n    return _.contains(this._neighbors, side);\n  },\n\n  setVisibilityMap: function(map) {\n    this._visibilityMap = map;\n  },\n\n  isVisible: function(cubeX, cubeY) {\n    return _.contains(this._visibilityMap[cubeX], cubeY);\n  },\n\n  /**\n   * Fetches specific tiles referenced by the passed indicies,\n   * or all tiles if indicies are not passed.\n   * @param  {[String|Number|Number[]]} indicies An array of indicies.\n   * @return {Tile[]}          An array of selected tiles.\n   */\n  getTiles: function(indicies) {\n    if (_.isUndefined(indicies)) {\n      return this._tiles;\n    }\n    return _.at(this._tiles, _.isArray(indicies) ? _.uniq(_.flatten(indicies)) : +indicies);\n  },\n\n  /**\n   * Returns all the tiles that are still unclaimed.\n   * @return {Array} A collection of unclaimed tiles.\n   */\n  getAvailableTiles: function() {\n    return _.reject(this._tiles, 'claimedBy');\n  },\n\n  _buildTiles: function(size) {\n\n    // First let's create an array of tiles based on the cube size.\n    var tiles = _.times(Math.pow(size, 2), index => new Tile(this, index)),\n\n    // Now we'll create lines from the tiles.\n    lines = {\n\n      // Creating x coordinate lines.\n      x: _.times(size, function(n) {\n          return new Line(tiles.slice(n * size, (n + 1) * size));\n        }),\n\n      // Creating y coordinate lines.\n      y: _.times(size, function(n) {\n          var arr = _.times(size, function(i) {\n            return n + i * size;\n          });\n          return new Line(_.at(tiles, arr));\n        })\n    };\n\n    // For each tile, assign the correct lines.\n    _.forEach(tiles, function(tile, index) {\n\n      var mod = index % size,\n          xLine = lines.x[(index - mod) / size],\n          yLine = lines.y[mod];\n\n      tile.updateLines(xLine, yLine);\n    });\n\n    // Return the tiles.\n    return tiles;\n  }\n\n};\n\nfunction Tile(side, index) {\n\n  // Set properties.\n  this.el = this.build(side.id + '-' + index);\n  this.side = side;\n  this.index = index;\n\n  this.claimedBy = null;\n  this.xLine = null;\n  this.yLine = null;\n\n  // Append the tile's element to the side.\n  side.el.appendChild(this.el);\n}\n\nTile.prototype = {\n\n  /**\n   * Outputs useful identifying information for troubleshooting.\n   * @return {String} Tile information.\n   */\n  toString: function() {\n    return this.el.id;\n  },\n\n  build: function(id) {\n\n    // Create the tile element.\n    var el = document.createElement('div');\n    el.id = id;\n    el.className = 'tile';\n\n    // Initialize after a random time. This begins the tile drop animation.\n    window.setTimeout(() => this.addClass('init'), Math.random() * 2000);\n\n    // debug\n    var idData = id.split('-');\n    el.appendChild(document.createTextNode(idData[0].slice(0, 2) + idData[1]));\n\n    return el;\n  },\n\n  claim: function(player) {\n    this.claimedBy = player;\n    this\n      .removeClass('unclaimed')\n      .addClass('preclaimed')\n      .addClass(player.tileClass);\n\n    UTIL.listenOnce(this.el, Vendor.EVENT.animationEnd, () => {\n      this.removeClass('preclaimed').addClass('claimed');\n    });\n  },\n\n  release: function() {\n    if (this.claimedBy) {\n      this\n        .addClass('unclaimed')\n        .removeClass('claimed')\n        .removeClass(this.claimedBy.tileClass)\n        .removeClass('win');\n      this.claimedBy = null;\n    }\n  },\n\n  isNeighboringSide: function(tile) {\n    return this.side.isNeighbor(tile.side);\n  },\n\n  addClass: function(name) {\n    this.el.classList.add(name);\n    return this;\n  },\n\n  removeClass: function(name) {\n    this.el.classList.remove(name);\n    return this;\n  },\n\n  updateLines: function(x, y) {\n    this.xLine = x;\n    this.yLine = y;\n  },\n\n  /**\n   * @return {Array} All the tiles composing both lines.\n   */\n  getAllLineTiles: function() {\n    return _.union(this.xLine.getTiles(), this.yLine.getTiles());\n  },\n\n  translate: function(toSide) {\n\n    // A translation is a recipe for morphing one line into another.\n    // It looks like this: [1, flip]\n    // Where: The first index is the coordinate to use in a line pair\n    //        The remaining indicies are methods to invoke on the line\n    var translation = Tile.translationMap[this.side.id][toSide ? toSide.id : null],\n\n        // The line from the line pair to use.\n        line = _.first(translation) === 'x' ? this.xLine : this.yLine;\n\n    if (translation) {\n\n      // Run through each translation method (flip, rotate) and return the result.\n      var newLine = _.reduce(_.rest(translation), function(transformedLine, method) {\n        return transformedLine[method]();\n      }, line);\n\n      return toSide.getTiles(newLine.indicies());\n    }\n\n    return null;\n  }\n\n};\n\nTile.translationMap = (function() {\n\n  var X = 'x',\n      Y = 'y',\n      FLIP = 'flip',\n      ROTATE = 'rotate';\n\n  // Line coordinate mapping to side id.\n  // [coordinate, methods...]\n  return {\n\n    front: {\n      top:      [Y],                // top\n      bottom:   [Y],                // bottom\n      left:     [X],                // left\n      right:    [X]                 // right\n    },\n\n    back: {\n      bottom:   [Y, FLIP],          // top\n      top:      [Y, FLIP],          // bottom\n      left:     [X],                // left\n      right:    [X]                 // right\n    },\n\n    top: {\n      back:     [Y, FLIP],          // top\n      front:    [Y],                // bottom\n      left:     [X, ROTATE],        // left\n      right:    [X, FLIP, ROTATE],  // right\n    },\n\n    bottom: {\n      front:    [Y],                // top\n      back:     [Y, FLIP],          // bottom\n      left:     [X, FLIP, ROTATE],  // left\n      right:    [X, ROTATE]         // right\n    },\n\n    left: {\n      top:      [Y, ROTATE],        // top\n      bottom:   [Y, FLIP, ROTATE],    // bottom\n      back:     [X],                // left\n      front:    [X]                 // right\n    },\n\n    right: {\n      top:      [Y, FLIP, ROTATE],  // top\n      bottom:   [Y, ROTATE],        // bottom\n      front:    [X],                // left\n      back:     [X]                 // right\n    }\n  };\n\n}());\n\nfunction SelectTileError(message) {\n  this.name = 'SelectTileError';\n  this.message = message;\n}\n\nSelectTileError.CLAIMED = 'claimed';\nSelectTileError.NOT_NEIGHBOR = 'notNeighbor';\nSelectTileError.TARGET_CLAIMED = 'targetClaimed';\n\nSelectTileError.prototype = new Error();\n\nfunction Messages() {\n  this.delay = 100;\n  this.queue = [];\n  this.container = this._buildContainer();\n  this.container.addEventListener(Vendor.EVENT.animationEnd, _.bind(this._remove, this));\n}\n\nMessages.prototype = {\n\n  listenTo: function(source) {\n    source.on('message', _.bind(this.add, this));\n  },\n\n  /**\n   * Creates a new message to add to the queue.\n   * @param {String} message The message text.\n   * @param {String} classes A space-separated list of classes to append to the message.\n   * @return {Messages} Returns itself for chaining.\n   */\n  add: function(message, classes) {\n\n    // Generate a new element to contain the message.\n    var item = document.createElement('li');\n\n    // Add special classes to decorate the message if passed.\n    // We want to use apply here because add takes multiple arguments,\n    // not an array of names.\n    if (classes) {\n      DOMTokenList.prototype.add.apply(item.classList, classes.split(' '));\n    }\n\n    // Get the correct message by passed key.\n    if (message.split(' ').length === 1) {\n      message = Messages.LIST[message];\n    }\n\n    // Append the message to the new element and queue it up.\n    item.appendChild(document.createTextNode(message));\n    this._enqueue(item);\n\n    return this;\n  },\n\n  /**\n   * Removes all persisted messages from the queue by adding the 'hide'\n   * class to each one.\n   */\n  removeAll: function() {\n    _.forEach(this.container.children, item => item.classList.add('hide'));\n  },\n\n  _enqueue: function(item) {\n\n    var container = this.container,\n        queue = this.queue,\n        delay = queue.length * this.delay;\n\n    queue.push(item);\n\n    _.delay(function(i) {\n      container.appendChild(item);\n      if (_.last(queue) === i) {\n        queue.length = 0;\n      }\n    }, delay, item);\n  },\n\n  /**\n   * Removes a message item referenced by the passed animationend event.\n   * The message will be removed if it's not persistent or it contains\n   * the 'hide' class.\n   * @param  {animationend} evt An animationend event.\n   */\n  _remove: function(evt) {\n    var classList = evt.target.classList;\n    if (!classList.contains('persist') || classList.contains('hide')) {\n      this.container.removeChild(evt.target);\n    }\n  },\n\n  _buildContainer: function() {\n    var container = document.createElement('ul');\n    container.id = 'messages';\n    document.body.appendChild(container);\n    return container;\n  }\n\n};\n\nMessages.LIST = {\n  claimed: 'This tile is already claimed!',\n  targetClaimed: 'The attack target is already claimed by you!',\n  sameSide: 'Same side! Choose a tile on a different side.',\n  notNeighbor: 'Not a neighboring side! Choose a tile different side.',\n  stalemate: 'Stalemate!',\n  newGame: 'Click anywhere to begin a new game.'\n};\n\nfunction Player(name, tileClass, cube) {\n  this.name = name;\n  this.tileClass = tileClass;\n  this._selectedTiles = [];\n  this._cubeCache = new CubeCache(cube);\n  EventEmitter2.call(this);\n}\n\nPlayer.prototype = {\n\n  isBot: function() {\n    return this instanceof Bot;\n  },\n\n  claim: function(tile) {\n    tile.claim(this);\n    this._cubeCache.add(tile);\n  },\n\n  release: function(tile) {\n    this._cubeCache.remove(tile);\n    tile.release();\n  },\n\n  releaseAll: function() {\n    _.forEach(this._cubeCache.getAllTiles(), tile => tile.release());\n    this._cubeCache.initialize();\n  },\n\n  getLines: function() {\n    return this._cubeCache.getLines();\n  },\n\n  /**\n   * @return {Array[Tile]} All the tiles claimed that do not compose lines.\n   */\n  getSingles: function() {\n    return this._cubeCache._singles;\n  },\n\n  /**\n   * @return {Tile} The first tile selected to be claimed.\n   */\n  getInitialTile: function() {\n    return _.first(this._selectedTiles);\n  },\n\n  getAttackTile: function(tile1, tile2) {\n    return this._cubeCache._cube.getAttackTile(tile1, tile2);\n  },\n\n  /**\n   * Win lines are completed lines. This method returns all the win\n   * lines claimed by the player.\n   * @return {Array} A collection of this player's win lines.\n   */\n  getWinLines: function() {\n    var size = this._cubeCache._cubeSize;\n    return _.filter(this.getLines(), function(line) {\n      return line.length() === size;\n    });\n  },\n\n  /**\n   * Dictates whether or not the player can attack the given tile.\n   * Basically, as long as the tile is not claimed by the player and\n   * is not some barrier, the tile can be attacked.\n   * @param  {Tile} tile The tile to check.\n   * @return {Boolean} Can the given tile be attacked by this player?\n   */\n  canAttack: function(tile) {\n    return tile.claimedBy !== this;\n  },\n\n  claimAll: function() {\n\n    _.forEach(this._selectedTiles, function(tile, index, array) {\n\n      // If the tile is already claimed, this is an attack! Release it.\n      // Also, replace it with attack data so the recorder will work.\n      if (tile.claimedBy) {\n        array[index] = this._createAttackData(tile);\n        tile.claimedBy.release(tile);\n      }\n\n      // Otherwise, claim that sucker.\n      else {\n        this.claim(tile);\n      }\n    }, this);\n\n    this.emit('player:claim', this._selectedTiles);\n    this._selectedTiles = [];\n  },\n\n  /**\n   * [selectTile description]\n   * @param  {Tile} tile The tile this player is trying to select.\n   * @param {Tile} [attackTile] The tile being attacked (if this is not the initial selection).\n   * @return {Boolean} Was this the last tile that needed to be selected?\n   */\n  selectTile: function(tile, attackTile) {\n\n    // Get a reference to the first tile selected.\n    var initialTile = _.first(this._selectedTiles);\n\n    // If a tile wasn't passed, exit immediately.\n    if (!tile) {\n      return;\n    }\n\n    // If the tile is already claimed, get outta dodge.\n    if (tile.claimedBy) {\n      throw new SelectTileError(SelectTileError.CLAIMED);\n    }\n\n    // If an initial tile exists, run some tests.\n    if (initialTile) {\n\n      // If the initial tile is selected, deselected it and bail out.\n      if (tile === initialTile) {\n        this.deselectTile(tile);\n        return;\n      }\n\n      // If the new selected tile is on the same side as the\n      // initial tile, deselect the initial tile.\n      if (tile.side === initialTile.side) {\n        this.deselectTile(initialTile);\n      }\n\n      // Else, if the side selected is not a neighbor, bail out.\n      else if (!initialTile.isNeighboringSide(tile)) {\n        throw new SelectTileError(SelectTileError.NOT_NEIGHBOR);\n      }\n    }\n\n    // If the attack tile exists, run even more tests.\n    if (attackTile) {\n\n      // If the attack tile is valid, that means both tiles can be selected\n      // and everything can be claimed. Exit true as we're done selecting tiles.\n      if (this.canAttack(attackTile)) {\n        this._selectTiles(tile, attackTile);\n        return true;\n      }\n      else {\n        throw new SelectTileError(SelectTileError.TARGET_CLAIMED);\n      }\n    }\n\n    // Otherwise, the initial tile must have been selected.\n    // Emit an event to celebrate this special occasion!\n    else {\n      this._selectTiles(tile);\n    }\n\n    // We still need to select more tiles this turn.\n    return false;\n  },\n\n  deselectTile: function(tile) {\n    _.pull(this._selectedTiles, tile);\n    this.emit('player:initialDeselected', tile);\n  },\n\n\n  /**\n   * Checks to see if the player has at least one valid move.\n   * @return {Boolean} Does a valid move exist?\n   */\n  hasValidMoves: function() {\n\n    /**\n     * Given a starting tile, attempt to match two more: a secondary tile\n     * and the attack tile.\n     * @param  {Tile} initial The starting tile to test.\n     * @return {Boolean} Was a successful match made?\n     */\n    var attempt = initial => {\n\n        // Loop through the tiles until two more selections are valid.\n        // If no matches are found, the attempt fails and returns false.\n        return _.some(tiles, function(tile) {\n\n          // Get the attack tile from the initial and tile intersection.\n          var attackTile = this.getAttackTile(initial, tile);\n\n          // If the attack tile and loop tile are valid, we're good!\n          return attackTile && selector.validate(tile, attackTile).success();\n        }, this);\n      },\n\n      // An array of all the available tiles for this player.\n      tiles = this._cubeCache._cube.getAvailableTiles(),\n\n      // A fresh TileSelector for making this discovery.\n      selector = new TileSelector(this);\n\n    // Run through all the tiles and try to find a match.\n    // If no match is found, false is returned.\n    return _.some(tiles, function(tile) {\n\n      // Reset the selector for a new starting point.\n      selector.reset();\n\n      // If the new tile is valid and the attempt to find two more succeeds,\n      // there is at least one valid move and true will be returned.\n      return selector.validate(tile).success() && attempt(tile);\n    });\n  },\n\n  _createAttackData: function(tile) {\n    return {\n      player: tile.claimedBy,\n      tile: tile,\n      toString: function() {\n        return '(attack -> ' + tile.toString() + ')'\n      }\n    };\n  },\n\n  _selectTiles: function() {\n    if (!this.getInitialTile()) {\n      this.emit('player:initialSelected', arguments[0]);\n    }\n    Array.prototype.push.apply(this._selectedTiles, arguments);\n    if (this._selectedTiles.length >= 3) {\n      this.claimAll();\n    }\n  }\n\n};\n\n// Mixin EventEmitter methods.\n_.assign(Player.prototype, EventEmitter2.prototype);\n\n// Assign Bot inheritence here because Bot is getting included first.\n// Need to switch to modules next go-round. For reals.\n// This is cheesey.\n(function() {\n  var botSelect = Bot.prototype._selectTiles;\n  _.assign(Bot.prototype, Player.prototype);\n  Bot.prototype._selectTiles = botSelect;\n}());\n\nfunction Recorder(app) {\n  this._timeline = [];\n  this._cursor = 0;\n  this._app = app;\n}\n\nRecorder.MESSAGES = {\n  NOT_FOUND: 'Could not locate a turn at ',\n  REWRITE: 'Turns are now being rewritten as the timeline was behind by ',\n  NO_LOG: '[No log for this turn]'\n};\n\nRecorder.prototype = {\n\n  record: function(player, tiles) {\n\n    var behind = this._timeline.length - this._cursor;\n\n    if (behind) {\n      console.warn(Recorder.MESSAGES.REWRITE + behind);\n      this._timeline = _.dropRight(this._timeline, behind);\n    }\n\n    this._package(player, tiles);\n    this._cursor++;\n  },\n\n  forward: function() {\n\n    var turnData = this._timeline[this._cursor];\n\n    if (turnData) {\n      _.forEach(turnData.tiles, function(tile) {\n        if (tile instanceof Tile) {\n          turnData.player.claim(tile);\n        }\n        else {\n          tile.player.release(tile.tile);\n        }\n      });\n      console.log(turnData.log);\n      this._cursor++;\n      this._app.setCurrentPlayer(this._app.getOpponent(turnData.player), true);\n    }\n    else {\n      throw Recorder.MESSAGES.NOT_FOUND + this._cursor;\n    }\n  },\n\n  reverse: function() {\n\n    var turnData = this._timeline[this._cursor - 1];\n\n    if (turnData) {\n      _.forEach(turnData.tiles, function(tile) {\n        if (tile instanceof Tile) {\n          turnData.player.release(tile);\n        }\n        else {\n          tile.player.claim(tile.tile);\n        }\n      });\n      this._cursor--;\n      this._app.setCurrentPlayer(turnData.player, true);\n    }\n    else {\n      throw Recorder.MESSAGES.NOT_FOUND + this._cursor;\n    }\n  },\n\n  _package: function(player, tiles) {\n    this._timeline.push({\n      player: player,\n      tiles: tiles,\n      log: player._logText || Recorder.MESSAGES.NO_LOG\n    });\n  }\n\n};\n\n/**\n * A software interface for determining which keyboard keys are pressed.\n *\n * @param {Array || String} keyCodes A collection of all the (string) keyCodes used.\n */\nfunction Keyboard(keyCodes) {\n\n  this.keys = {};\n\n  if (typeof keyCodes === 'string') {\n    keyCodes = keyCodes.split(' ');\n  }\n  while (keyCodes.length) {\n    this.keys[keyCodes.pop()] = false;\n  }\n\n}\n\nKeyboard.prototype = { \n\n  listen: function(win, callback) {\n\n    var UNDEFINED = 'undefined',\n        keys = this.keys;\n        \n    if (!win) {\n      win = window;\n    }\n\n    win.addEventListener('keydown', function(evt) {\n      var keyCode = evt.keyCode;\n      if (typeof keys[keyCode] !== UNDEFINED && !keys[keyCode]) {\n        keys[keyCode] = true;\n        if (callback) {\n          callback();\n        }\n      }\n    });\n\n    win.addEventListener('keyup', function(evt) {\n      var keyCode = evt.keyCode;\n      if (keys[keyCode]) {\n        keys[keyCode] = false;\n        if (callback) {\n          callback();\n        }\n      }\n    });\n\n  }\n\n};\n\nKeyboard.UP = '38';\nKeyboard.DOWN = '40';\nKeyboard.LEFT = '37';\nKeyboard.RIGHT = '39';\nKeyboard.W = '87';\nKeyboard.A = '65';\nKeyboard.S = '83';\nKeyboard.D = '68';\nKeyboard.SPACE = '32';\nKeyboard.ESCAPE = '27';\n\nfunction Renderer(cube, isMobile) {\n\n  // A reference to the game cube.\n  this.cube = cube;\n\n  // The keyboard interface for desktop interactions.\n  this.keyboard = null;\n\n  // And this is for touch interactions.\n  this.touch = null;\n\n  // The speed to animate the X axis.\n  this.moveX = 0;\n\n  // The speed to animate the Y axis.\n  this.moveY = 0;\n\n  // The total number of steps to animate a rotation.\n  this.tickMax = 90;\n\n  // The number of rendering steps left to animate.\n  this.tick = 0;\n\n  // How fast each tick animates.\n  this.speed = 5;\n\n  // Is the client a mobile device?\n  this.isMobile = isMobile;\n\n  // EventEmitter constructor call.\n  EventEmitter2.call(this);\n}\n\nRenderer.prototype = {\n\n  initialize: function() {\n    if (this.isMobile) {\n      this._listenForTouch();\n    }\n    else {\n      this._listenForKeyboard();\n    }\n    this.cube.setRenderer(this);\n  },\n\n  draw: function() {\n\n    // Reduce the ticks and rotate the cube\n    this.tick -= this.speed;\n    this.cube.rotate(this.moveX, this.moveY);\n\n    // If there are ticks left or a key is down, keep looping.\n    if (this.tick > 0 || this._setMovement()) {\n      this._loop();\n    }\n\n    // Otherwise, broadcast an event signifying that the rendering has completed.\n    else {\n      this.emit('end');\n    }\n  },\n\n  /**\n   * A public interface for manually setting the movement.\n   * @param {Number} x The target x coordinate.\n   * @param {Number} y The target y coordinate.\n   * @return {Promise} A promise that resolves when the movement animation ends.\n   */\n  setMovement: function(x, y) {\n\n    /**\n     * Configure a move in one direction and start the render loop.\n     * @param {Number} tick The distance to rotate.\n     * @param {String} coorProp Which coordinate to rotate on (moveX or moveY).\n     */\n    var move = (tick, coorProp) => {\n      this.tick = Math.abs(tick);\n      this[coorProp] = !tick ? 0 : tick < 0 ? -this.speed : this.speed;\n      this._loop();\n    };\n\n    // Return a promise that will resolve when both x and y movements are complete.\n    return new Promise(resolve => {\n      move(x, 'moveX');\n      this.once('end', () => {\n        move(y, 'moveY');\n        this.once('end', resolve);\n      });\n    });\n  },\n\n  _listenForKeyboard: function() {\n\n    this.keyboard = new Keyboard([\n      Keyboard.UP,\n      Keyboard.DOWN,\n      Keyboard.LEFT,\n      Keyboard.RIGHT,\n      Keyboard.W,\n      Keyboard.A,\n      Keyboard.S,\n      Keyboard.D\n    ]);\n\n    // Listen for keystrokes.\n    this.keyboard.listen(window, this._movementListener.bind(this));\n  },\n\n  _listenForTouch: function() {\n    this.touch = new Touch();\n    this.touch.listen(document.body, this._movementListener.bind(this));\n  },\n\n  _loop: function() {\n    window.requestAnimationFrame(this.draw.bind(this));\n  },\n\n  _movementListener: function() {\n    if (this.tick <= 0 && this._setMovement()) {\n      this._loop();\n      this.emit('start');\n    }\n  },\n\n  _setMovement: function() {\n\n    // reset movex and movey\n    this.moveX = this.moveY = 0;\n\n    // Set the movement direction depending on the environment.\n    if (this.isMobile) {\n      this._setTouchMovement();\n    }\n    else {\n      this._setKeyboardMovement();\n    }\n\n    // If there is movement, set tick and return true.\n    if (this.moveX !== 0 || this.moveY !== 0) {\n      this.tick = this.tickMax;\n      return true;\n    }\n\n    // Movement was not set.\n    return false;\n  },\n\n  _setKeyboardMovement: function() {\n\n    var KB = Keyboard,\n        keys = this.keyboard.keys;\n\n    // Detect either up or down movement.\n    if (keys[KB.UP] || keys[KB.W]) {\n      this.moveX = this.speed;\n    }\n    else if (keys[KB.DOWN] || keys[KB.S]) {\n      this.moveX = -this.speed;\n    }\n\n    // Detect either left or right movement.\n    if (keys[KB.LEFT] || keys[KB.A]) {\n      this.moveY = this.speed;\n    }\n    else if (keys[KB.RIGHT] || keys[KB.D]) {\n      this.moveY = -this.speed;\n    }\n  },\n\n  _setTouchMovement: function() {\n\n    var movement = this.touch.queue.shift();\n\n    switch (movement) {\n      case Touch.UP:\n        this.moveX = -this.speed;\n        break;\n      case Touch.DOWN:\n        this.moveX = this.speed;\n        break;\n      case Touch.LEFT:\n        this.moveY = this.speed;\n        break;\n      case Touch.RIGHT:\n        this.moveY = -this.speed;\n        break;\n    }\n  }\n\n};\n\n// Mixin the EventEmitter methods for great justice.\n// Ditch when we migrate to Browserify.\n_.assign(Renderer.prototype, EventEmitter2.prototype);\n\nfunction Touch() {\n  this.queue = [];\n}\n\nTouch.prototype = {\n\n  listen: function(context, callback) {\n\n    var iface = new Hammer(context || document.body),\n        queue = this.queue;\n\n    iface\n      .get('swipe')\n      .set({\n        direction: Hammer.DIRECTION_ALL,\n        threshold: 0.1,\n        velocity: 0.1\n      });\n\n    iface.on('swipe', function(evt) {\n      queue.push(evt.offsetDirection);\n      if (callback) {\n        callback();\n      }\n    });\n  }\n\n};\n\nTouch.UP = Hammer.DIRECTION_UP;\nTouch.DOWN = Hammer.DIRECTION_DOWN;\nTouch.LEFT = Hammer.DIRECTION_LEFT;\nTouch.RIGHT = Hammer.DIRECTION_RIGHT;\n\nfunction CubeCache(cube) {\n\n  // A reference to the cube.\n  this._cube = cube;\n\n  // The size to check completed lines against.\n  this._cubeSize = cube.size;\n\n  // Create cache objects to hold claimed tiles.\n  this.initialize();\n}\n\nCubeCache.prototype = {\n\n  /**\n   * Called on instantiation and reset, this initialize a fresh cache\n   * in two collecitons: An object keyed by cube side id to contain lines\n   * and an array to contain single tiles.\n   */\n  initialize: function() {\n\n    // A collection of lines created by side.\n    this._lineMap = _.reduce(this._cube.getSides(), (sides, side, id) => {\n      sides[id] = [];\n      return sides;\n    }, {});\n\n    // A collection of claimed tiles that are not part of lines.\n    this._singles = [];\n  },\n\n  add: function(tile) {\n\n    var claimedBy = tile.claimedBy,\n        xPartial = this._getPartialLineTiles(tile.xLine, claimedBy),\n        yPartial = this._getPartialLineTiles(tile.yLine, claimedBy),\n        xGrow = this._growLine(xPartial),\n        yGrow = this._growLine(yPartial);\n\n    // If a line was grown or created from this tile, ensure it's removed from\n    // the singles collection.\n    if (xGrow || yGrow) {\n      this._singles = _.difference(this._singles, tile.getAllLineTiles());\n    }\n\n    // Else, add the tile to the singles collection.\n    else {\n      this._singles.push(tile);\n    }\n  },\n\n  remove: function(tile) {\n\n    var claimedBy = tile.claimedBy,\n        xPartial = this._getPartialLineTiles(tile.xLine, claimedBy),\n        yPartial = this._getPartialLineTiles(tile.yLine, claimedBy),\n        xShrink,\n        yShrink;\n\n    _.pull(xPartial, tile);\n    _.pull(yPartial, tile);\n\n    xShrink = this._shrinkLine(xPartial, true);\n    yShrink = this._shrinkLine(yPartial, false);\n\n    // If there's some shrinkage, update the singles collection accordingly.\n    if (xShrink || yShrink) {\n\n      // We need to make sure that the tiles gathered in the partial are\n      // not part of another line. If they are, don't add them as singles.\n      if (xShrink && !this._composesLines(xPartial)) {\n        this._singles = _.union(this._singles, xPartial);\n      }\n      if (yShrink && !this._composesLines(yPartial)) {\n        this._singles = _.union(this._singles, yPartial);\n      }\n    }\n\n    // Otherwise, safely remove the tile from the singles collection\n    // if it exists in there.\n    else {\n      _.pull(this._singles, tile);\n    }\n  },\n\n  /**\n   * Retrieves all the lines, sorted by the number of tiles contained\n   * in each line.\n   * @return {Array} A collection of lines.\n   */\n  getLines: function() {\n    return this._getLinesAsChain()\n      .sortBy(line => line._tiles.length)\n      .value();\n  },\n\n  /**\n   * Retrieves all cached tiles.\n   * @return {Array} A colleciton of all the cached tiles.\n   */\n  getAllTiles: function() {\n    return this._getLinesAsChain()\n      .map(line => line.getTiles())\n      .flatten()\n      .uniq()\n      .concat(this._singles)\n      .value();\n  },\n\n  /**\n   * Fetches a chain-wrapped collection of cached lines, flattened and\n   * compacted into one array.\n   * @return {lodash} A lodash chain-wrapped collection.\n   */\n  _getLinesAsChain: function() {\n    return _.chain(this._lineMap)\n      .values()\n      .flatten()\n      .compact()\n  },\n\n  _getPartialLineTiles: function(line, claimedBy) {\n    return _.filter(line.getTiles(), tile => tile.claimedBy === claimedBy);\n  },\n\n  _growLine: function(tiles) {\n\n    var side, line;\n\n    if (tiles.length > 1) {\n\n      side = this._lineMap[_.first(tiles).side.id];\n      line = _.find(side, function(ln) {\n        return ln.some(tiles);\n      });\n\n      // If a line exists already, update it with the new tiles.\n      if (line) {\n        line.update(tiles);\n      }\n\n      // Otherwise, create a new line with the given tiles.\n      else {\n        side.push(new Line(tiles));\n      }\n\n      // A line was created or updated.\n      return true;\n    }\n\n    // A line was not created.\n    return false;\n  },\n\n  /**\n   * Shrinks a line.\n   * @param  {Array} tiles The tiles used in the shrinkage\n   * @return {Boolean} Was a line disassebled?\n   */\n  _shrinkLine: function(tiles, isHorizontal) {\n\n    var side, line;\n\n    if (tiles.length) {\n\n      side = this._lineMap[_.first(tiles).side.id];\n      line = _.find(side, function(ln) {\n        return ln.isHorizontal() === isHorizontal && ln.all(tiles);\n      });\n\n      // Line should exist but just in case...\n      if (line) {\n\n        // If there's only one tile, it's not a line. Pull it.\n        if (tiles.length === 1) {\n          _.pull(side, line);\n\n          // A line was disassembled. Return true.\n          return true;\n        }\n\n        // Otherwise, update the line with the remaining tiles.\n        else {\n          line.update(tiles);\n        }\n      }\n    }\n\n    // A line was not disassembled.\n    return false;\n  },\n\n  _composesLines: function(tiles) {\n    var side = this._lineMap[_.first(tiles).side.id];\n    return _.find(side, function(line) {\n      return line.all(tiles);\n    });\n  }\n\n};\n\nclass TileSelector {\n\n  constructor(player) {\n    this._player = player;\n    this.reset();\n  }\n\n  reset() {\n    this._selected = [];\n  }\n\n  validate(tile, attackTile) {\n\n    // Get a reference to the first tile selected.\n    var initial = _.first(this._selected),\n\n        // A package of data sent in resolved promises.\n        resolveData = {};\n\n    // If a tile wasn't passed, exit immediately.\n    if (!tile) {\n      return TileSelectorResult.failure();\n    }\n\n    // If the tile is already claimed, get outta dodge.\n    if (tile.claimedBy) {\n      return TileSelectorResult.failure(TileSelectorResult.FAILURE_CLAIMED);\n    }\n\n    // If an initial tile exists, run some tests.\n    if (initial) {\n\n      // If the initial tile is selected, deselected it and bail out.\n      if (tile === initial) {\n        return TileSelectorResult.success(\n          this._deselect(tile)\n        );\n      }\n\n      // If the new selected tile is on the same side as the\n      // initial tile, deselect the initial tile.\n      if (tile.side === initial.side) {\n        resolveData = this._deselect(initial);\n      }\n\n      // Else, if the side selected is not a neighbor, bail out.\n      else if (!initial.isNeighboringSide(tile)) {\n        return TileSelectorResult.failure(TileSelectorResult.FAILURE_NOT_NEIGHBOR);\n      }\n    }\n\n    // If the attack tile exists, run even more tests.\n    if (attackTile) {\n\n      // If the attack tile is valid, that means both tiles can be selected\n      // and everything can be claimed. Exit true as we're done selecting tiles.\n      if (this._player.canAttack(attackTile)) {\n        return TileSelectorResult.success(\n          _.merge(resolveData, this._select(tile, attackTile))\n        );\n      }\n      else {\n        return TileSelectorResult.failure(TileSelectorResult.FAILURE_CANNOT_ATTACK);\n      }\n    }\n\n    // Otherwise, the initial tile must have been selected. Pass the resolve data\n    // along in case a tile was deselected first (as in the side === side case).\n    else {\n      return TileSelectorResult.success(\n        _.merge(resolveData, this._select(tile))\n      );\n    }\n\n    // We'll probably never make it this far but let's return a promise just in case.\n    return TileSelectorResult.failure();\n  }\n\n  _select() {\n    var tiles = _.toArray(arguments);\n    Array.prototype.push.apply(this._selected, tiles);\n    return {\n      select: tiles,\n      length: this._selected.length\n    };\n  }\n\n  /**\n   * Removes a tile from the _selected array and returns a command object\n   * describing the action. This object will eventually be passed to a\n   * Promise returned from validate().\n   * @param  {Tile} tile The tile to remove.\n   * @return {Object} A command object describing the action.\n   */\n  _deselect(tile) {\n    _.pull(this._selected, tile);\n    return {\n      deselect: [tile]\n    };\n  }\n\n}\n\n/**\n * Used in TileSelector, the TileSelectorResult object provides an\n * easy to use API for interacting with validate calls.\n * In general, these objects should be created with the static methods.\n *\n * Common use cases with TileSelector:\n *\n * var selector = new TileSelector(player);\n *\n * 1.\n * selector.validate(tile).success() -> Returns a boolean\n *\n * 2.\n * selector\n *   .validate(tile)\n *   .success(function(data) {\n *     // Do something with success data.\n *   })\n *   .failure(function(code) {\n *     // React to error code.\n *   });\n */\nclass TileSelectorResult {\n\n  /**\n   * Constructor method. Sets properties intended to be private.\n   * @param  {Boolean} success Is the result successful?\n   * @param  {String|Object} data A payload describing the result.\n   *                              Strings for failure codes and objects for result metadata.\n   * @constructor\n   */\n  constructor(success, data) {\n    this._success = success;\n    this._data = data;\n  }\n\n  /**\n   * One of the chainable callbacks, success will either return a boolean\n   * describing the success state or itself if a callback is provided.\n   * The callback will be invoked if the success state is true.\n   * @param  {Function} callback A method to invoke if the success state is true,\n   *                             passing the _data value.\n   * @return {TileSelectorResult} Returns itself for chaining.\n   */\n  success(callback) {\n    if (!callback) {\n      return this._success;\n    }\n    if (this._success) {\n      callback(this._data);\n    }\n    return this;\n  }\n\n  /**\n   * The other chainable callback, failure will either return a boolean\n   * describing the success state or itself if a callback is provided.\n   * The callback will be invoked if the success state is false.\n   * @param  {Function} callback A method to invoke if the success state is false,\n   *                             passing the _data value.\n   * @return {TileSelectorResult} Returns itself for chaining.\n   */\n  failure(callback) {\n    if (!callback) {\n      return !this._success;\n    }\n    if (!this._success) {\n      callback(this._data);\n    }\n    return this;\n  }\n\n  /**\n   * The recommended method for creating a new successful TileSelectorResult.\n   * @param  {Object} data A map describing the success state.\n   * @return {TileSelectorResult} A new successful TileSelectorResult.\n   * @static\n   */\n  static success(data) {\n    return new TileSelectorResult(true, data);\n  }\n\n  /**\n   * The recommended method for creating a new failed TileSelectorResult.\n   * @param  {String} code The failure code.\n   * @return {TileSelectorResult} A new failed TileSelectorResult.\n   * @static\n   */\n  static failure(code) {\n    return new TileSelectorResult(false, code);\n  }\n\n}\n\n// Failure codes.\nTileSelector.FAILURE_CLAIMED = 'claimed';\nTileSelector.FAILURE_NOT_NEIGHBOR = 'notNeighbor';\nTileSelector.FAILURE_CANNOT_ATTACK = 'cannotAttack';\n\n/**\n * A lightweight guided tutorial helper that is attached to a specific\n * event-emitting object, such as the cube. Displays helpful messages\n * to teach the player how to play.\n * @param {Object} target An event-emitting object to provide guidance for.\n * @class\n */\nfunction Tutorial() {\n\n  // What step is the tutorial on?\n  this.step = 0;\n\n  // How many steps are there?\n  this.maxStep = 5;\n\n  // EventEmitter constructor call.\n  EventEmitter2.call(this);\n}\n\nTutorial.prototype = {\n\n  next: function() {\n    if (!this.isDone()) {\n      this.emit('message', Tutorial.stepMessages[this.step], 'info');\n      this.step++;\n    }\n    return this;\n  },\n\n  isDone: function() {\n    return this.step >= this.maxStep;\n  }\n\n};\n\n// Mixin EventEmitter methods.\n_.assign(Tutorial.prototype, EventEmitter2.prototype);\n\n// List of step messages.\nTutorial.stepMessages = [\n  'Let\\'s play! Click any tile to begin.',\n  'Rotate the cube using the arrow keys or WASD.',\n  'Great! Now, click a tile on an adjacent side.',\n  'Nice! A third tile was selected automatically for you.',\n  'Try to make a line on one side.'\n];\n\n(function(win) {\n\n  win.UTIL = {\n\n    listenOnce: function(target, type, callback) {\n      var handler = evt => {\n        target.removeEventListener(type, handler);\n        callback(evt);\n      };\n      target.addEventListener(type, handler);\n    }\n\n  };\n\n}(window));\n\n(function(win) {\n\n  var STYLE = document.body.style,\n\n      TRANSFORM = 'Transform',\n\n      // Prefixes used for things like Transform.\n      STYLE_PREFIXES = ['ms', 'O', 'Moz', 'Webkit'],\n\n      // Animation end events. Not quite perfect as IE10+\n      // actually uses 'animation' -> 'MSAnimationEnd'\n      // I'll fix this later.\n      // So ridiculous. Can't these be consistent?!\n      // ...\n      // Map format:\n      // 'css-attribute':       [start, iteration, end]\n      ANIMATION_EVENT_MAP = {\n        'animation':            ['animationstart', 'animationiteration', 'animationend'],\n        '-o-animation':         ['oAnimationStart', 'oAnimationIteration', 'oAnimationEnd'],\n        '-moz-animation':       ['animationstart', 'animationiteration', 'animationend'],\n        '-webkit-animation':    ['webkitAnimationStart', 'webkitAnimationIteration', 'webkitAnimationEnd']\n      },\n\n      msAnimationEnd = 'MSAnimationEnd',//TODO\n      \n      len = STYLE_PREFIXES.length,\n\n      stylePrefix,\n\n      animationProperty,\n\n      eventTypes,\n\n      vendor = {\n        JS: {},\n        CSS: {},\n        EVENT: {}\n      };\n\n  // First, let's determine the style prefix.\n  while (len--) {\n    if ((STYLE_PREFIXES[len] + TRANSFORM) in STYLE) {\n      stylePrefix = STYLE_PREFIXES[len];\n      break;\n    }\n  }\n\n  // If there isn't a proper prefix, use the standard transform.\n  if (!stylePrefix) {\n    stylePrefix = TRANSFORM.toLowerCase();\n  }\n\n  // Next, let's set some properties using the prefix.\n  vendor.JS.transform = stylePrefix + TRANSFORM;\n  vendor.CSS.transform = stylePrefix ? '-' + stylePrefix.toLowerCase() + '-transform' : 'transform';\n\n  // Now, let's determine the event end name. So messed up.\n  for (animationProperty in ANIMATION_EVENT_MAP) {\n    if (typeof STYLE[animationProperty] !== 'undefined') {\n      eventTypes = ANIMATION_EVENT_MAP[animationProperty];\n      vendor.EVENT.animationStart = eventTypes[0];\n      vendor.EVENT.animationIteration = eventTypes[1];\n      vendor.EVENT.animationEnd = eventTypes[2];\n      break;\n    }\n  }\n\n  // Normalize requestAnimationFrame for cross-browser compatibility.\n  win.requestAnimationFrame = win.requestAnimationFrame || win.mozRequestAnimationFrame || win.webkitRequestAnimationFrame || win.msRequestAnimationFrame;    \n\n  // Set the global Vendor variable.\n  win.Vendor = vendor;\n\n}(window));\n"]}